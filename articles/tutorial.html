<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="babette">
<title>babette Tutorial • babette</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="babette Tutorial">
<meta property="og:description" content="babette">
<meta property="og:image" content="https://docs.ropensci.org/babette/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">babette</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/demo.html">babette demo</a>
    <a class="dropdown-item" href="../articles/examples.html">Examples</a>
    <a class="dropdown-item" href="../articles/nested_sampling.html">Nested Sampling</a>
    <a class="dropdown-item" href="../articles/step_by_step.html">babette: Step by Step</a>
    <a class="dropdown-item" href="../articles/tutorial.html">babette Tutorial</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/babette/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>babette Tutorial</h1>
                        <h4 data-toc-skip class="author">Richèl J.C. Bilderbeek</h4>
            
            <h4 data-toc-skip class="date">2024-03-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/babette/blob/HEAD/vignettes/tutorial.Rmd" class="external-link"><code>vignettes/tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>tutorial.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><img src="babette_logo.png"></p>
<p>This vignette is a tutorial how to use <code>babette</code> and its most important <code>bbt_run_from_model</code> function.</p>
<p>First, load <code>babette</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/babette/">babette</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: beautier</span></span>
<span><span class="co">#&gt; Loading required package: beastier</span></span>
<span><span class="co">#&gt; Warning: package 'beastier' was built under R version 4.3.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'beastier'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:beautier':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     is_on_appveyor, is_on_ci, is_on_travis</span></span>
<span><span class="co">#&gt; Loading required package: mauricer</span></span>
<span><span class="co">#&gt; Warning: package 'mauricer' was built under R version 4.3.3</span></span>
<span><span class="co">#&gt; Loading required package: tracerer</span></span>
<span><span class="co">#&gt; Warning: package 'tracerer' was built under R version 4.3.3</span></span></code></pre></div>
<p>The main function of <code>babette</code> is <code>bbt_run_from_model</code>. Here is part of its help:</p>
<pre><code>Do a full run: create a 'BEAST2' configuration file (like BEAUti 2), 
run 'BEAST2', parse results (like Tracer)

Usage

bbt_run_from_model(
  fasta_filename,
  inference_model,
  beast2_options
)</code></pre>
<p>Simplifying this to all arguments that do not have a default:</p>
<pre><code><span><span class="fu"><a href="../reference/bbt_run_from_model.html">bbt_run_from_model</a></span><span class="op">(</span></span>
<span>  <span class="va">fasta_filename</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="fasta_filename">
<code>fasta_filename</code><a class="anchor" aria-label="anchor" href="#fasta_filename"></a>
</h2>
<p><code>fasta_filename</code> is the argument to specify which FASTA file to work on. <code>babette</code> is bundled with some FASTA files, so obtaining a path to a FASTA file is easy:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fasta_filename</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_babette_path.html">get_babette_path</a></span><span class="op">(</span><span class="st">"anthus_aco_sub.fas"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://testthat.r-lib.org" class="external-link">testthat</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://testthat.r-lib.org/reference/logical-expectations.html" class="external-link">expect_true</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">fasta_filename</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>With <code>fasta_filename</code> available, we have the minimal requirements to call <code>bbt_run_from_model</code> like this:</p>
<pre><code><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bbt_run_from_model.html">bbt_run_from_model</a></span><span class="op">(</span><span class="va">fasta_filename</span><span class="op">)</span></span></code></pre>
<p>Note that this code is not ran, as it would take too long. The reason this would take too long, is that the MCMC run that will be executed is set to one million states by default. To specify the MCMC options and shorten this run, the <code>mcmc</code> argument is used.</p>
</div>
<div class="section level2">
<h2 id="inference_model-and-mcmc">
<code>inference_model</code> and <code>mcmc</code><a class="anchor" aria-label="anchor" href="#inference_model-and-mcmc"></a>
</h2>
<p>The inference run’s MCMC is part of the inference model. To get an inference model with a short MCMC, create a test inference model like this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inference_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/create_test_inference_model.html" class="external-link">create_test_inference_model</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">inference_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "site_model"        "clock_model"       "tree_prior"       </span></span>
<span><span class="co">#&gt; [4] "mrca_prior"        "mcmc"              "beauti_options"   </span></span>
<span><span class="co">#&gt; [7] "tipdates_filename"</span></span></code></pre></div>
<p><code>mcmc</code> is the <code>inference_model</code> argument to specify the MCMC run options:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">inference_model</span><span class="op">$</span><span class="va">mcmc</span><span class="op">$</span><span class="va">chain_length</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3000</span></span></code></pre></div>
<p>With these MCMC options, we can now call <code>bbt_run_from_model</code> in way that it will finish fast:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://docs.ropensci.org/beastier/reference/is_beast2_installed.html" class="external-link">is_beast2_installed</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">beast2_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beastier/reference/create_beast2_options.html" class="external-link">create_beast2_options</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bbt_run_from_model.html">bbt_run_from_model</a></span><span class="op">(</span></span>
<span>    fasta_filename <span class="op">=</span> <span class="va">fasta_filename</span>,</span>
<span>    inference_model <span class="op">=</span> <span class="va">inference_model</span>,</span>
<span>    beast2_options <span class="op">=</span> <span class="va">beast2_options</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/bbt_delete_temp_files.html">bbt_delete_temp_files</a></span><span class="op">(</span></span>
<span>    inference_model <span class="op">=</span> <span class="va">inference_model</span>,</span>
<span>    beast2_options <span class="op">=</span> <span class="va">beast2_options</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The return value, <code>out</code> contains the results of the MCMC run. For this tutorial, visualizing <code>out</code> is ignored, as the ‘Demo’ vignette discusses this. Instead, we will work through the other <code>bbt_run_from_model</code> parameters.</p>
</div>
<div class="section level2">
<h2 id="site_model">
<code>site_model</code><a class="anchor" aria-label="anchor" href="#site_model"></a>
</h2>
<p><code>site_model</code> is the <code>inference_model</code> parameter for a site model. As this tutorial works on a DNA alignment, such a site model can also be called a nucleotide substitution model.</p>
<p>Picking a site model is easy: just type:</p>
<pre><code><span><span class="va">create_site_model_</span></span></code></pre>
<p>This will trigger auto-complete to show all site models.</p>
<p>The simplest site model is the Jukes-Cantor DNA substitution model. To use this model in <code>babette</code>, do:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inference_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/create_test_inference_model.html" class="external-link">create_test_inference_model</a></span><span class="op">(</span></span>
<span>  site_model <span class="op">=</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/create_jc69_site_model.html" class="external-link">create_jc69_site_model</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Using this site model:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://docs.ropensci.org/beastier/reference/is_beast2_installed.html" class="external-link">is_beast2_installed</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">beast2_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beastier/reference/create_beast2_options.html" class="external-link">create_beast2_options</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bbt_run_from_model.html">bbt_run_from_model</a></span><span class="op">(</span></span>
<span>    fasta_filename <span class="op">=</span> <span class="va">fasta_filename</span>,</span>
<span>    inference_model <span class="op">=</span> <span class="va">inference_model</span>,</span>
<span>    beast2_options <span class="op">=</span> <span class="va">beast2_options</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/bbt_delete_temp_files.html">bbt_delete_temp_files</a></span><span class="op">(</span></span>
<span>    inference_model <span class="op">=</span> <span class="va">inference_model</span>,</span>
<span>    beast2_options <span class="op">=</span> <span class="va">beast2_options</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="clock_model">
<code>clock_model</code><a class="anchor" aria-label="anchor" href="#clock_model"></a>
</h2>
<p><code>clock_models</code> is the <code>inference_model</code> parameter for a clock model.</p>
<p>Picking a clock model is easy: just type:</p>
<pre><code><span><span class="va">create_clock_model_</span></span></code></pre>
<p>This will trigger auto-complete to show all clock models.</p>
<p>The simplest site model is the strict clock model. To use this model in <code>babette</code>, do:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inference_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/create_test_inference_model.html" class="external-link">create_test_inference_model</a></span><span class="op">(</span></span>
<span>  clock_model <span class="op">=</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/create_strict_clock_model.html" class="external-link">create_strict_clock_model</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Using this clock model:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://docs.ropensci.org/beastier/reference/is_beast2_installed.html" class="external-link">is_beast2_installed</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">beast2_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beastier/reference/create_beast2_options.html" class="external-link">create_beast2_options</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bbt_run_from_model.html">bbt_run_from_model</a></span><span class="op">(</span></span>
<span>    fasta_filename <span class="op">=</span> <span class="va">fasta_filename</span>,</span>
<span>    inference_model <span class="op">=</span> <span class="va">inference_model</span>,</span>
<span>    beast2_options <span class="op">=</span> <span class="va">beast2_options</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/bbt_delete_temp_files.html">bbt_delete_temp_files</a></span><span class="op">(</span></span>
<span>    inference_model <span class="op">=</span> <span class="va">inference_model</span>,</span>
<span>    beast2_options <span class="op">=</span> <span class="va">beast2_options</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tree_prior">
<code>tree_prior</code><a class="anchor" aria-label="anchor" href="#tree_prior"></a>
</h2>
<p><code>tree_prior</code> is the <code>inference_model</code> parameter to select a tree prior.</p>
<p>Picking a tree prior is easy: just type:</p>
<pre><code><span><span class="va">create_tree_prior_</span></span></code></pre>
<p>This will trigger auto-complete to show all tree priors.</p>
<p>The simplest tree prior is the Yule (pure-birth) tree prior. To use this model in <code>babette</code>, do:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inference_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/create_test_inference_model.html" class="external-link">create_test_inference_model</a></span><span class="op">(</span></span>
<span>  tree_prior <span class="op">=</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/create_yule_tree_prior.html" class="external-link">create_yule_tree_prior</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Using this tree prior:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://docs.ropensci.org/beastier/reference/is_beast2_installed.html" class="external-link">is_beast2_installed</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">beast2_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beastier/reference/create_beast2_options.html" class="external-link">create_beast2_options</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bbt_run_from_model.html">bbt_run_from_model</a></span><span class="op">(</span></span>
<span>    fasta_filename <span class="op">=</span> <span class="va">fasta_filename</span>,</span>
<span>    inference_model <span class="op">=</span> <span class="va">inference_model</span>,</span>
<span>    beast2_options <span class="op">=</span> <span class="va">beast2_options</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/bbt_delete_temp_files.html">bbt_delete_temp_files</a></span><span class="op">(</span></span>
<span>    inference_model <span class="op">=</span> <span class="va">inference_model</span>,</span>
<span>    beast2_options <span class="op">=</span> <span class="va">beast2_options</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mrca_prior">
<code>mrca_prior</code><a class="anchor" aria-label="anchor" href="#mrca_prior"></a>
</h2>
<p><code>mrca_priors</code> is the <code>inference_model</code> parameter to use a Most Recent Common Ancestor (hence, MRCA) prior. With such a prior, it can be specified which taxa have a shared common ancestor and when it existed.</p>
<p>Here is how to specify that the first two taxa in a FASTA file are sister species:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mrca_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/create_mrca_prior.html" class="external-link">create_mrca_prior</a></span><span class="op">(</span></span>
<span>  alignment_id <span class="op">=</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/get_alignment_id.html" class="external-link">get_alignment_id</a></span><span class="op">(</span>fasta_filename <span class="op">=</span> <span class="va">fasta_filename</span><span class="op">)</span>,</span>
<span>  taxa_names <span class="op">=</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/get_taxa_names.html" class="external-link">get_taxa_names</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="va">fasta_filename</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  is_monophyletic <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>To specify when the MRCA of all taxa was present, we’ll first create a prior distribution of the crown age, after which we can use that distribution.</p>
<p>To assume the crown age to follow a normal distribution, with a mean of 15.0 (time units), with a standard deviation of 1.0, use <code>create_normal_distr</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mrca_distr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/create_normal_distr.html" class="external-link">create_normal_distr</a></span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">15.0</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">1.0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>To use that distribution in our MRCA prior:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mrca_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/create_mrca_prior.html" class="external-link">create_mrca_prior</a></span><span class="op">(</span></span>
<span>  alignment_id <span class="op">=</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/get_alignment_id.html" class="external-link">get_alignment_id</a></span><span class="op">(</span>fasta_filename <span class="op">=</span> <span class="va">fasta_filename</span><span class="op">)</span>,</span>
<span>  taxa_names <span class="op">=</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/get_taxa_names.html" class="external-link">get_taxa_names</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="va">fasta_filename</span><span class="op">)</span>,</span>
<span>  mrca_distr <span class="op">=</span> <span class="va">mrca_distr</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Using such an MRCA prior:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inference_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beautier/reference/create_test_inference_model.html" class="external-link">create_test_inference_model</a></span><span class="op">(</span></span>
<span>  mrca_prior <span class="op">=</span> <span class="va">mrca_prior</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://docs.ropensci.org/beastier/reference/is_beast2_installed.html" class="external-link">is_beast2_installed</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">beast2_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/beastier/reference/create_beast2_options.html" class="external-link">create_beast2_options</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bbt_run_from_model.html">bbt_run_from_model</a></span><span class="op">(</span></span>
<span>    fasta_filename <span class="op">=</span> <span class="va">fasta_filename</span>,</span>
<span>    inference_model <span class="op">=</span> <span class="va">inference_model</span>,</span>
<span>    beast2_options <span class="op">=</span> <span class="va">beast2_options</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/bbt_delete_temp_files.html">bbt_delete_temp_files</a></span><span class="op">(</span></span>
<span>    inference_model <span class="op">=</span> <span class="va">inference_model</span>,</span>
<span>    beast2_options <span class="op">=</span> <span class="va">beast2_options</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
